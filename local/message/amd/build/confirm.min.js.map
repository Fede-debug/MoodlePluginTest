{"version":3,"file":"confirm.min.js","sources":["../src/confirm.js"],"sourcesContent":["\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n//namespace local_message;\n\n/**\n * Hook callbacks for usertours.\n *\n * @module     local_message\n * @copyright  Federico Diana\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n//import ModalFactory from 'core/modal_factory';\n\n// require(['jquery', 'core/modal_factory'], function($) {\n\n\n//     window.console.log('test');\n//     window.console.log($('.local_message_delete_button'));\n\n//     var trigger = $('.local_message_delete_button');\n\n//         ModalFactory.create({\n//         title: 'test title',\n//         body: '<p>test body content</p>',\n//         footer: 'An example footer content',\n//     }, trigger)\n// .done(function(/*modal*/){\n//     Y.log('Finished modal');\n// });\n// });\nimport ModalSaveCancel from 'core/modal_save_cancel';\nimport { get_string as getString } from 'core/str';\nimport jQuery from 'jquery';\nimport ModalEvents from 'core/modal_events';\nimport Ajax from 'core/ajax'\nimport Notification from 'core/notification';\n\nexport const init = async (button) => {\n    const modal = await ModalSaveCancel.create({\n        title: getString('message_deletion', 'local_message'),\n        body: getString('delete_message_confirm', 'local_message'),\n        // preShowCallBack: function(triggerelement, modalsingle) {\n        //     window.console.log('test');\n        //     window.console.log(triggerelement);\n\n        //     let classListString = triggerelement.classList[0];\n        //     let messageid = classListString.substr(classListString.lastIndexOf('local_message') + 'local_message'.length);\n\n        //     modalsingle.params = {'messageid': messageid};\n        // }\n        large: true\n    });\n\n    window.console.log(button);\n\n    modal.getRoot().on(ModalEvents.shown, (e) => {\n        // window.console.log('test');\n        //     window.console.log(e);\n\n        //     let triggerElement = $(e);\n\n        //     window.console.log(triggerElement);\n\n        let classListString = button.classList[0];\n        let messageid = classListString.substr(classListString.lastIndexOf('local_message') + 'local_message'.length);\n\n        modal.params = { 'messageid': messageid };\n\n    });\n\n    modal.getRoot().on(ModalEvents.save, (e) => {\n        e.preventDefault();\n\n        console.log(modal.params);\n\n        let request = {\n            methodname: 'local_message_delete_message',\n            args: modal.params,\n        };\n\n        Ajax.call([request])[0].done(function (data) {\n            if (data === true) {\n                //window.location.reload();\n                console.log('deleted message successfully');\n            } else {\n                Notification.addNotification({\n                    message: getString('delete_message_failed', 'local_message'),\n                    type: 'error'\n                });\n            }\n        }).fail(function (error) {\n            console.log(error);\n            Notification.Exception;\n        });\n\n    });\n\n    // ...\n    modal.setSaveButtonText(getString('delete_button_modal', 'local_message'));\n    //modal.param('messageid', messageid);\n    modal.show();\n};\n\n//init.apply();\n// jQuery('local_message_delete_button').click(function(){\n//     //do something here\n//     init.apply();\n// });\n\n// document.querySelector('.local_message_delete_button').addEventListener('click', event => init.apply());\n\nconst deleteButtons = document.querySelectorAll('.local_message_delete_button');\n//deleteButton.addEventListener('click', onDeleteButtonClick);\n\n\ndeleteButtons.forEach(button => {\n    button.addEventListener('click', onDeleteButtonClick);\n    // let classListString = button.classList[0];\n    // let myid = classListString.substr(classListString.lastIndexOf('local_message') + 'local_message'.length);\n    //  button.myParam = myid;\n});\n\n\n\nfunction onDeleteButtonClick() {\n\n    // window.console.log(this);\n    //Y.log('Y log test');\n    //let messageid = classListString.substr(classListString.lastIndeOf('local_messageid') + 'local_messageid'.length);\n    //window.console.log(event.currentTarget.myParam);\n\n    let button = this;\n\n    window.console.log(button);\n\n    init.call(this, button);\n}"],"names":["init","async","modal","ModalSaveCancel","create","title","body","large","window","console","log","button","getRoot","on","ModalEvents","shown","e","classListString","classList","messageid","substr","lastIndexOf","length","params","save","preventDefault","request","methodname","args","call","done","data","addNotification","message","type","fail","error","Exception","setSaveButtonText","show","onDeleteButtonClick","this","document","querySelectorAll","forEach","addEventListener"],"mappings":";;;;;;;0UAmDaA,KAAOC,MAAAA,eACVC,YAAcC,2BAAgBC,OAAO,CACvCC,OAAO,mBAAU,mBAAoB,iBACrCC,MAAM,mBAAU,yBAA0B,iBAU1CC,OAAO,IAGXC,OAAOC,QAAQC,IAAIC,QAEnBT,MAAMU,UAAUC,GAAGC,sBAAYC,OAAQC,QAQ/BC,gBAAkBN,OAAOO,UAAU,GACnCC,UAAYF,gBAAgBG,OAAOH,gBAAgBI,YAAY,iBAAmB,gBAAgBC,QAEtGpB,MAAMqB,OAAS,WAAeJ,cAIlCjB,MAAMU,UAAUC,GAAGC,sBAAYU,MAAOR,IAClCA,EAAES,iBAEFhB,QAAQC,IAAIR,MAAMqB,YAEdG,QAAU,CACVC,WAAY,+BACZC,KAAM1B,MAAMqB,sBAGXM,KAAK,CAACH,UAAU,GAAGI,MAAK,SAAUC,OACtB,IAATA,KAEAtB,QAAQC,IAAI,sDAECsB,gBAAgB,CACzBC,SAAS,mBAAU,wBAAyB,iBAC5CC,KAAM,aAGfC,MAAK,SAAUC,OACd3B,QAAQC,IAAI0B,6BACCC,gBAMrBnC,MAAMoC,mBAAkB,mBAAU,sBAAuB,kBAEzDpC,MAAMqC,oCAwBDC,sBASLhC,OAAOC,QAAQC,IAFF+B,MAIbzC,KAAK6B,KAAKY,KAJGA,MApBKC,SAASC,iBAAiB,gCAIlCC,SAAQjC,SAClBA,OAAOkC,iBAAiB,QAASL"}